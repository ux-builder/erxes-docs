import { Libraries } from '@/components/Libraries'
import { Developer } from '@/components/Developer'
import { HeroPattern } from '@/components/HeroPattern'
import { Lib } from '@/components/Lib'

export const metadata = {
  title: 'Development',
  description:
    'Protocolì€ APIë¥¼ ì‚¬ìš©í•  ë•Œ ì—¬ëŸ¬ë¶„ì˜ ì‚¶ì„ ë” í¸ë¦¬í•˜ê²Œ ë§Œë“¤ê³  ìµœê³ ì˜ ê²½í—˜ì„ ì œê³µí•˜ê¸° ìœ„í•´ ì˜ ì¡°ì •ëœ JavaScript, Ruby, PHP, Python ë° Go ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.'
}

<HeroPattern />
# ê°œë°œ

<Developer />

# ì¼ë°˜ í”ŒëŸ¬ê·¸ì¸ ìƒì„±

erxesë¥¼ ì‚¬ìš©í•˜ë©´ ìì²´ í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ í”ŒëŸ¬ê·¸ì¸ì„ í™•ì¥í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ì œí’ˆ/ì„œë¹„ìŠ¤ì˜ ê°€ì¹˜ë¥¼ ì¶”ê°€í•˜ì—¬ ê²½í—˜ì„ í–¥ìƒì‹œí‚¤ê³  ìˆ˜ìµì„ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ [ìš°ë¦¬ì˜ ë§ˆì¼“í”Œë ˆì´ìŠ¤](https://erxes.io/marketplace)<script src='https://cdn.jsdelivr.net/gh/eddymens/markdown-external-link-script@v2.0.0/main.min.js'></script>ì—ì„œ íŒë§¤í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ ê°€ì´ë“œëŠ” ìì²´ í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.

<Caution>
- ìì²´ í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•˜ê¸° ì „ì— ë™ì¼í•œ ì´ë¦„ ë˜ëŠ” ìœ ì‚¬í•œ ì´ë¦„ì˜ í”ŒëŸ¬ê·¸ì¸ì´ ë§ˆì¼“í”Œë ˆì´ìŠ¤ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ì´ë¦„ì€ `API`, `GraphQL`, `query`, `mutation` ë“± ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©ë˜ë¯€ë¡œ í˜¼ë™ì„ í”¼í•˜ê¸° ìœ„í•´ ì¤‘ìš”í•©ë‹ˆë‹¤.
- ì´ë¦„ì€ ì†Œë¬¸ìë§Œ ì‚¬ìš©í•˜ë©°, ê¸°í˜¸ì™€ ê³µë°±ì„ í¬í•¨í•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.
- ëª¨ë“  `GraphQL` íƒ€ì…, `query`, `mutation`ì˜ ì´ë¦„ì€ í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ìœ¼ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.
- ë°ì´í„°ë² ì´ìŠ¤ ì»¬ë ‰ì…˜ì˜ ì´ë¦„ë„ í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ìœ¼ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.
- **UIroutes** ë˜ëŠ” `url`ì˜ ì´ë¦„ë„ í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ìœ¼ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.
</Caution>

# erxes ì„¤ì¹˜

---

erxes XOSë¥¼ ì„¤ì¹˜í•˜ë ¤ë©´ [ì„¤ì¹˜ ê°€ì´ë“œ](/quickstart/groups)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”. ê·¸ëŸ¬ë‚˜ ë™ì¼í•œ ë°©í–¥ìœ¼ë¡œ erxesë¥¼ ì‹¤í–‰í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.

<Danger>
erxes XOSê°€ ì´ë¯¸ ì¥ì¹˜ì— ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì•„ë˜ ê°€ì´ë“œë¼ì¸ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. [ì„¤ì¹˜ ê°€ì´ë“œ](/quickstart/groups)ë¥¼ ì‚¬ìš©í•˜ì—¬ erxes XOSë¥¼ ì„¤ì¹˜í•œ í›„ ë‹¤ì‹œ ì˜¤ì‹­ì‹œì˜¤.
</Danger>

<Libraries />

<Lib />

# ìƒˆë¡œìš´ í”ŒëŸ¬ê·¸ì¸ ìƒì„±

ê° í”ŒëŸ¬ê·¸ì¸ì€ `API`ì™€ `UI` ë‘ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

- ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ë¶€ë¶„ì˜ ìƒˆ í´ë”ë¥¼ ìƒì„±í•˜ì„¸ìš”.

```bash {{ title: '' }}
    cd erxes
    yarn create-plugin 
```

ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ CLIê°€ ì‹œì‘ë˜ë©°, ìƒˆ í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ëª‡ ê°€ì§€ ì§ˆë¬¸ì´ í‘œì‹œë©ë‹ˆë‹¤. ì•„ë˜ ì˜ˆì œì—ì„œëŠ” documentë¼ëŠ” ì´ë¦„ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/6e30c8b7-5396-48a2-3b4a-8b2223080400/public)

ì•„ë˜ ì˜ˆì œëŠ” ë©”ì¸ ë‚´ë¹„ê²Œì´ì…˜ì— ë°°ì¹˜ëœ ì˜ˆì œ í…œí”Œë¦¿ì—ì„œ ìƒì„±ëœ ìƒˆ í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/88dccd76-b921-441f-e903-7ff31b278900/public)

ë¹ˆ í…œí”Œë¦¿ì—ì„œ ìƒì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ í‘œì‹œë©ë‹ˆë‹¤. ì´ëŠ” erxesì—ì„œ ììœ ë¡­ê²Œ í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•  ìˆ˜ ìˆë„ë¡ ê³µê°„ì„ ì œê³µí•©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/fe16b5f8-e361-4194-87ff-772616413300/public)

# API íŒŒì¼ êµ¬ì¡°

í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•œ í›„ì—ëŠ” ìƒˆ í”ŒëŸ¬ê·¸ì¸ APIì— ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ë“¤ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.
```bash {{ title: '' }}
ğŸ“¦plugin-document-api
 â”£ ğŸ“‚src
 â”ƒ â”£ ğŸ“‚graphql
 â”ƒ â”ƒ â”£ ğŸ“‚resolvers 
 â”ƒ â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”ƒ â”£ mutations.ts
 â”ƒ â”ƒ â”ƒ â”— queries.ts
 â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”— typeDefs.ts
 â”ƒ â”£ configs.ts
 â”ƒ â”£ messageBroker.ts
 â”ƒ â”— models.ts
 â”£ .env.sample
 â”£ package.json
 â”— tsconfig.json
```

### ì£¼ìš” íŒŒì¼
plugin-[pluginName]-api/srcì— ë‹¤ìŒ íŒŒì¼ë“¤ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

### configs.ts
ì´ íŒŒì¼ì€ í”ŒëŸ¬ê·¸ì¸ì˜ ì£¼ìš” ì„¤ì •ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'configs.ts file:' }}
// path: ./packages/plugin-[pluginName]-api/src/configs.ts 
import typeDefs from './graphql/typeDefs';
import resolvers from './graphql/resolvers';
import { initBroker } from './messageBroker';
export let mainDb;
export let debug;
export let graphqlPubsub;
export let serviceDiscovery;
export default {
  name: '[pluginName]',
  graphql: async sd => {
    serviceDiscovery = sd;
    return {
      typeDefs: await typeDefs(sd),
      resolvers: await resolvers(sd)
    };
  },
  apolloServerContext: async (context) => {
    return context;
  },
  onServerInit: async options => {
    mainDb = options.db;
    initBroker(options.messageBrokerClient);
    graphqlPubsub = options.pubsubClient;
    debug = options.debug;
  }
}
```
### messageBroker.ts
ì´ íŒŒì¼ì€ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ê³¼ ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ê³µí†µ ê¸°ëŠ¥ì—ì„œ ë©”ì‹œì§€ ë¸Œë¡œì»¤ í•¨ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: ' messageBroker.ts file:' }}
// path: ./packages/plugin-[pluginName]-api/src/messageBroker.ts 
import { ISendMessageArgs, sendMessage } from "@erxes/api-utils/src/core";
import { serviceDiscovery } from "./configs";
import { Documents } from "./models";
let client;
export const initBroker = async cl => {
  client = cl;
  const { consumeQueue, consumeRPCQueue } = client;
  consumeQueue('document:send', async ({ data }) => {
    Documents.send(data);
    return {
      status: 'success',
    };
  });
  consumeRPCQueue('document:find', async ({ data }) => {
    return {
      status: 'success',
      data: await Documents.find({})
    };
  });
};
export const sendCommonMessage = async (
  args: ISendMessageArgs & { serviceName: string }
) => {
  return sendMessage({
    serviceDiscovery,
    client,
    ...args
  });
};
export default function() {
  return client;
}
```

## GraphQL ê°œë°œ
`packages/plugin-<new_plugin>-api/src` ë‚´ë¶€ì—ëŠ” `graphql` í´ë”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í´ë”ì—ëŠ” GraphQLê³¼ ê´€ë ¨
```tsx
 ğŸ“‚src
 â”£ ğŸ“‚graphql
 â”ƒ â”£ ğŸ“‚resolvers 
 â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”£ mutations.ts
 â”ƒ â”ƒ â”— queries.ts
 â”ƒ â”£ index.ts
 â”ƒ â”— typeDefs.ts
 ```
### GraphQL ë¦¬ì¡¸ë²„
`/graphql/resolvers/mutations` ë‚´ë¶€ì—ëŠ” GraphQL ë³€ì´ ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: ' mutation examples:' }}
import { Documents, Types } from '../../models';
import { IContext } from "@erxes/api-utils/src/types"
const documentMutations = {
/**
 * ìƒˆë¡œìš´ ë¬¸ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤
 */
async documentsAdd(_root, doc, _context: IContext) {
  return Documents.createDocument(doc);
},
/**
 * ë¬¸ì„œë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤
 */
async documentsEdit(
  _root,
  { _id, ...doc },
  _context: IContext
) {
  return Documents.updateDocument(_id, doc);
},
/**
 * ë‹¨ì¼ ë¬¸ì„œë¥¼ ì œê±°í•©ë‹ˆë‹¤
 */
async documentsRemove(_root, { _id }, _context: IContext) {
  return Documents.removeDocument(_id);
},
/**
 * ë¬¸ì„œë¥¼ ìœ„í•œ ìƒˆë¡œìš´ ìœ í˜•ì„ ìƒì„±í•©ë‹ˆë‹¤
 */
async documentTypesAdd(_root, doc, _context: IContext) {
  return Types.createType(doc);
},
async documentTypesRemove(_root, { _id }, _context: IContext) {
  return Types.removeType(_id);
},
async documentTypesEdit(
  _root,
  { _id, ...doc },
  _context: IContext
) {
return Types.updateType(_id, doc);
}
};
export default documentMutations;
```
### `/graphql/resolvers/queries` í´ë” ë‚´ë¶€ì—ëŠ” GraphQL ì¿¼ë¦¬ ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: ' query examples:' }}
import { Documents, Types } from "../../models";
import { IContext } from "@erxes/api-utils/src/types"
const documentQueries = {
  documents(
    _root,
    {
      typeId
    },
    _context: IContext
  ) {
    const selector: any = {};
    if (typeId) {
      selector.typeId = typeId;
    }
    return Documents.find(selector).sort({ order: 1, name: 1 });
  },
  documentTypes(_root, _args, _context: IContext) {
    return Types.find({});
  },
  documentsTotalCount(_root, _args, _context: IContext) {
    return Documents.find({}).countDocuments();
  }
};
export default documentQueries;
```
### GraphQL typeDefs
`/graphql/typeDefs.ts` íŒŒì¼ ë‚´ë¶€ì—ëŠ” GraphQL typeDefsê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: ' typeDefs:' }}
import { gql } from 'apollo-server-express';
const types = `
  type Document {
    _id: String!
    name: String
    createdAt:Date
    expiryDate:Date
    checked:Boolean
    typeId: String
  
    currentType: DocumentType
  }
  type DocumentType {
    _id: String!
    name: String
  }
`;
const queries = `
  documents(typeId: String): [Document]
  documentTypes: [DocumentType]
  documentsTotalCount: Int
`;
const params = `
  name: String,
  expiryDate: Date,
  checked: Boolean,
  typeId:String
`;
const mutations = `
  documentsAdd(${params}): Document
  documentsRemove(_id: String!): JSON
  documentsEdit(_id:String!, ${params}): Document
  documentTypesAdd(name:String):DocumentType
  documentTypesRemove(_id: String!):JSON
  documentTypesEdit(_id: String!, name:String): DocumentType
`;
const typeDefs = async _serviceDiscovery => {
  return gql`
    scalar JSON
    scalar Date
    ${types}
    
    extend type Query {
      ${queries}
    }
    
    extend type Mutation {
      ${mutations}
    }
  `;
};
export default typeDefs;

```

ë°ì´í„°ë² ì´ìŠ¤ ê°œë°œ
`packages/plugin-<new_plugin>-api/src` ë‚´ë¶€ì—ëŠ” `models` íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤. ì´ íŒŒì¼ì—ëŠ” MongoDBì™€ mongooseì™€ ê´€ë ¨ëœ ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```tsx
ğŸ“‚src
â”— models.ts
```
### Mongoose schema and model
Inside `src/models.ts`, file contains Mongoose schema and models.
```bash {{ title: ' Mongoose schema and model example:' }}
import * as _ from 'underscore';
import { model } from 'mongoose';
import { Schema } from 'mongoose';
export const typeSchema = new Schema({
  name: String
});
export const documentSchema = new Schema({
  name: String,
  createdAt: Date,
  expiryDate: Date,
  checked: Boolean,
  typeId: String
});
export const loadTypeClass = () => {
  class Type {
    public static async getType(_id: string) {
      const type = await Types.findOne({ _id });
      if (!type) {
        throw new Error('Type not found');
      }
      return type;
    }
    // create type
    public static async createType(doc) {
      return Types.create({ ...doc });
    }
    // remove type
    public static async removeType(_id: string) {
      return Types.deleteOne({ _id });
    }
    public static async updateType(_id: string, doc) {
      return Types.updateOne({ _id }, { $set: { ...doc } });
    }
  }
  typeSchema.loadClass(Type);
  return typeSchema;
};
export const loadDocumentClass = () => {
  class Document {
    public static async getDocument(_id: string) {
      const document = await Documents.findOne({ _id });
      if (!document) {
        throw new Error('Document not found');
      }
      return document;
    }
    // create
    public static async createDocument(doc) {
      return Documents.create({
        ...doc,
        createdAt: new Date()
      });
    }
    // update
    public static async updateDocument (_id: string, doc) {
      await Documents.updateOne(
        { _id },
        { $set: { ...doc } }
      ).then(err => console.error(err));
    }
    // remove
    public static async removeDocument(_id: string) {
      return Documents.deleteOne({ _id });
    }
  }
documentSchema.loadClass(Document);
return documentSchema;
};
loadDocumentClass();
loadTypeClass();
// tslint:disable-next-line
export const Types = model<any, any>(
  'document_types',
  typeSchema
);
// tslint:disable-next-line
export const Documents = model<any, any>('documents', documentSchema);
```

## UI íŒŒì¼ êµ¬ì¡°
`yarn-create-plugin` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆ í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•œ í›„, ìƒˆë¡œìš´ í”ŒëŸ¬ê·¸ì¸ UIì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

```tsx
ğŸ“¦plugin-[pluginName]-ui
 â”£ ğŸ“‚src
 â”ƒ â”£ ğŸ“‚components
 â”ƒ â”ƒ â”£ Form.tsx
 â”ƒ â”ƒ â”£ List.tsx
 â”ƒ â”ƒ â”£ Row.tsx
 â”ƒ â”ƒ â”£ SideBar.tsx
 â”ƒ â”ƒ â”— TypeForm.tsx
 â”ƒ â”£ ğŸ“‚containers
 â”ƒ â”ƒ â”£ List.tsx
 â”ƒ â”ƒ â”— SideBarList.tsx
 â”ƒ â”£ ğŸ“‚graphql
 â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”£ mutations.ts
 â”ƒ â”ƒ â”— queries.ts
 â”ƒ â”£ App.tsx
 â”ƒ â”£ configs.js
 â”ƒ â”£ generalRoutes.tsx
 â”ƒ â”£ index.js
 â”ƒ â”£ routes.tsx
 â”ƒ â”— types.ts
 ```
## ì£¼ìš” íŒŒì¼
ë‹¤ìŒ íŒŒì¼ë“¤ì€ `plugin-[pluginName]-ui/src`ì— ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

### configs.js
ì´ íŒŒì¼ì—ëŠ” í”ŒëŸ¬ê·¸ì¸ì˜ ì£¼ìš” ì„¤ì •ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'configs.js file:' }}
// path: ./packages/plugin-[pluginName]-ui/src/configs.js 
  module.exports = {
    name: '[pluginName]',
    port: 3017,
    scope: '[pluginName]',
    exposes: {
      './routes': './src/routes.tsx'
    },
    routes: {
      url: 'http://localhost:3017/remoteEntry.js',
      scope: '[pluginName]',
      module: './routes'
    },
    menus:[
        {
          "text":"[pluginName]",
          "url":"/[pluginUrl]",
          "icon":"icon-star",
          "location":"[mainNavigation or settings]"
        }
      ]
  };
  ```

### routes.tsx
ì´ íŒŒì¼ì—ëŠ” í”ŒëŸ¬ê·¸ì¸ UIì˜ ë¼ìš°íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'routes.tsx file:' }}
// path: ./packages/plugin-[pluginName]-ui/src/routes.tsx 
  import asyncComponent from '@erxes/ui/src/components/AsyncComponent';
  import queryString from 'query-string';
  import React from 'react';
  import { Route } from 'react-router-dom';
  const List = asyncComponent(() =>
    import(/* webpackChunkName: "List - Documents" */ './containers/List')
  );
  const documents = ({ location, history }) => {
    const queryParams = queryString.parse(location.search);
    const { type } = queryParams;
    return <List typeId={type} history={history} />;
  };
  const routes = () => {
    return <Route path="/documents/" component={documents} />;
  };
```

### App.tsx
ì´ íŒŒì¼ì—ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'App.tsx file:' }}
// path: ./packages/plugin-[pluginName]-ui/src/App.tsx 
  import React from 'react';
  import GeneralRoutes from './generalRoutes';
  import { PluginLayout } from '@erxes/ui/src/styles/main';
  const App = () => {
    return (
      <PluginLayout>
        <GeneralRoutes />
      </PluginLayout>
    );
  };
  export default App;
  ```

# UI ê°œë°œ
### Components
`src` í´ë” ë‚´ì— `components` í´ë”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í´ë”ì—ëŠ” í”ŒëŸ¬ê·¸ì¸ì˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```tsx
 ğŸ“‚src
 â”£ ğŸ“‚components
 â”ƒ â”£ Form.tsx
 â”ƒ â”£ List.tsx
 â”ƒ â”£ Row.tsx
 â”ƒ â”£ SideBar.tsx
 â”ƒ â”— TypeForm.tsx
 ```
```bash {{ title: 'components example:' }}
 // path: ./packages/plugin-[pluginName]-ui/src/components/TypeForm.tsx 
  import { __ } from '@erxes/ui/src/utils/core';
  import React from 'react';
  import { IType } from '../types';
  import { IButtonMutateProps, IFormProps } from '@erxes/ui/src/types';
  import Form from '@erxes/ui/src/components/form/Form';
  import {
    ControlLabel,
    FormControl,
    FormGroup
  } from '@erxes/ui/src/components/form';
  import Button from '@erxes/ui/src/components/Button';
  import { ModalFooter } from '@erxes/ui/src/styles/main';
  type Props = {
    renderButton: (props: IButtonMutateProps) => JSX.Element;
    closeModal?: () => void;
    afterSave?: () => void;
    remove?: (type: IType) => void;
    types?: IType[];
    type: IType;
  };
  const TypeForm = (props: Props) => {
    const { type, closeModal, renderButton, afterSave } = props;
    const generateDoc = (values: {
      _id?: string;
      name: string;
      content: string;
    }) => {
      const finalValues = values;
      const { type } = props;
      if (type) {
        finalValues._id = type._id;
      }
      return {
        ...finalValues
      };
    };
    const renderContent = (formProps: IFormProps) => {
      const { values, isSubmitted } = formProps;
      const object = type || ({} as any);
      return (
        <>
          <FormGroup>
            <ControlLabel required={true}>Todo Type</ControlLabel>
            <FormControl
              {...formProps}
              name='name'
              defaultValue={object.name}
              type='text'
              required={true}
              autoFocus={true}
            />
          </FormGroup>
          <ModalFooter id={'AddTypeButtons'}>
            <Button btnStyle='simple' onClick={closeModal} icon='times-circle'>
              Cancel
            </Button>
            {renderButton({
              passedName: 'type',
              values: generateDoc(values),
              isSubmitted,
              callback: closeModal || afterSave,
              object: type
            })}
          </ModalFooter>
        </>
      );
    };
    return <Form renderContent={renderContent} />;
  };
  export default TypeForm;
  ```

### Containers
`src` í´ë” ë‚´ì— `containers` í´ë”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í´ë”ì—ëŠ” APIì™€ ê´€ë ¨ëœ ì½”ë“œê°€ í¬í•¨ëœ ì»´í¬ë„ŒíŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```tsx
 ğŸ“‚src
  â”£ ğŸ“‚containers
  â”ƒ â”£ List.tsx
  â”ƒ â”— SideBarList.tsx
  ```
```bash {{ title: 'containers example:' }}
  // path: ./packages/plugin-[pluginName]-ui/src/containers/SideBarList.tsx 
  import gql from 'graphql-tag';
  import * as compose from 'lodash.flowright';
  import { graphql } from 'react-apollo';
  import { Alert, confirm, withProps } from '@erxes/ui/src/utils';
  import SideBar from '../components/SideBar';
  import {
    EditTypeMutationResponse,
    RemoveTypeMutationResponse,
    TypeQueryResponse
  } from '../types';
  import { mutations, queries } from '../graphql';
  import React from 'react';
  import { IButtonMutateProps } from '@erxes/ui/src/types';
  import ButtonMutate from '@erxes/ui/src/components/ButtonMutate';
  import Spinner from '@erxes/ui/src/components/Spinner';
  type Props = {
    history: any;
    currentTypeId?: string;
  };
  type FinalProps = {
    listTemplateTypeQuery: TypeQueryResponse;
  } & Props &
    RemoveTypeMutationResponse &
    EditTypeMutationResponse;
  const TypesListContainer = (props: FinalProps) => {
    const { listTemplateTypeQuery, typesEdit, typesRemove, history } = props;
    if (listTemplateTypeQuery.loading) {
      return <Spinner />;
    }
    // calls gql mutation for edit/add type
    const renderButton = ({
      passedName,
      values,
      isSubmitted,
      callback,
      object
    }: IButtonMutateProps) => {
      return (
        <ButtonMutate
          mutation={object ? mutations.editType : mutations.addType}
          variables={values}
          callback={callback}
          isSubmitted={isSubmitted}
          type="submit"
          successMessage={`You successfully ${
            object ? 'updated' : 'added'
          } a ${passedName}`}
          refetchQueries={['listTemplateTypeQuery']}
        />
      );
    };
    const remove = type => {
      confirm('You are about to delete the item. Are you sure? ')
        .then(() => {
          typesRemove({ variables: { _id: type._id } })
            .then(() => {
              Alert.success('Successfully deleted an item');
            })
            .catch(e => Alert.error(e.message));
        })
        .catch(e => Alert.error(e.message));
    };
    const updatedProps = {
      ...props,
      types: listTemplateTypeQuery.templateTypes || [],
      loading: listTemplateTypeQuery.loading,
      remove,
      renderButton
    };
    return <SideBar {...updatedProps} />;
  };
  export default withProps<Props>(
    compose(
      graphql(gql(queries.listTemplateTypes), {
        name: 'listTemplateTypeQuery',
        options: () => ({
          fetchPolicy: 'network-only'
        })
      }),
      graphql(gql(mutations.removeType), {
        name: 'typesRemove',
        options: () => ({
          refetchQueries: ['listTemplateTypeQuery']
        })
      })
    )(TypesListContainer)
  );
  ```
### GraphQL
`src` í´ë” ë‚´ì— `graphql` í´ë”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í´ë”ì—ëŠ” GraphQLê³¼ ê´€ë ¨ëœ ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
```tsx
ğŸ“‚src
 â”£ ğŸ“‚graphql
 â”ƒ â”£ index.ts
 â”ƒ â”£ mutations.ts
 â”ƒ â”— queries.ts
 ```
 Inside `/graphql/mutations.ts` GraphQL mutation codes.

```bash {{ title: 'GraphQL mutation examples:' }}
const add = `
  mutation documentsAdd($name: String!, $expiryDate: Date, $typeId:String) {
    documentsAdd(name:$name, expiryDate: $expiryDate, typeId:$typeId) {
      name
      _id
      expiryDate
      typeId
    }
  }
`;

const remove = `
  mutation documentsRemove($_id: String!){
    documentsRemove(_id: $_id)
  }
  `;

const edit = `
  mutation documentsEdit($_id: String!, $name:String, $expiryDate:Date, $checked:Boolean, $typeId:String){
    documentsEdit(_id: $_id, name: $name, expiryDate:$expiryDate, checked:$checked, typeId:$typeId){
      _id
    }
  }
  `;

const addType = `
  mutation typesAdd($name: String!){
    documentTypesAdd(name:$name){
      name
      _id
    }
  }
  `;

const removeType = `
  mutation typesRemove($_id:String!){
    documentTypesRemove(_id:$_id)
  }
`;

const editType = `
  mutation typesEdit($_id: String!, $name:String){
    documentTypesEdit(_id: $_id, name: $name){
      _id
    }
  }
`;

export default {
  add,
  remove,
  edit,
  addType,
  removeType,
  editType
};
```

### `/graphql/queries.ts` íŒŒì¼ì—ëŠ” GraphQL query ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'GraphQL query examples:' }}
const list = `
  query listQuery($typeId: String) {
    documents(typeId: $typeId) {
      _id
      name
      expiryDate
      createdAt
      checked
      typeId
      currentType{
        _id
        name
      }
    }
  }
`;
const listDocumentTypes = `
  query listDocumentTypeQuery{
    documentTypes{
      _id
      name
    }
  }
`;
const totalCount = `
  query documentsTotalCount{
    documentsTotalCount
  }
`;
export default {
  list,
  totalCount,
  listDocumentTypes
};
```

# UI ì„¤ì •
# í”ŒëŸ¬ê·¸ì¸ ì‹¤í–‰ í¬íŠ¸
`packages/plugin-<new_plugin>-ui/src/configs.js` íŒŒì¼ ë‚´ì— í”ŒëŸ¬ê·¸ì¸ UIì˜ ì‹¤í–‰ í¬íŠ¸ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ê°’ì€ 3017ì…ë‹ˆë‹¤. ê° í”ŒëŸ¬ê·¸ì¸ì€ ê³ ìœ í•œ í¬íŠ¸ì—ì„œ UIê°€ ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì—¬ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•˜ëŠ” ê²½ìš° `configs.js` íŒŒì¼ ë‚´ì—ì„œ í¬íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
module.exports = {
  name: 'new_plugin',
  port: 3017,
  scope: 'new_plugin',
  exposes: {
    './routes': './src/routes.tsx'
  },
  routes: {
    url: 'http://localhost:3017/remoteEntry.js',
    scope: 'new_plugin',
    module: './routes'
  },
  menus: []
};
```
# í”ŒëŸ¬ê·¸ì¸ ìœ„ì¹˜
`packages/plugin-<new_plugin>-ui/src/configs.js` íŒŒì¼ ë‚´ì— ì„¤ì • ì„¹ì…˜ì´ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì˜ˆì‹œëŠ” ìƒˆ í”ŒëŸ¬ê·¸ì¸ì„ ë©”ì¸ ë‚´ë¹„ê²Œì´ì…˜ ë©”ë‰´ì— ë°°ì¹˜í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

```tsx
menus: [
  {
    text: 'New plugin',
    url: '/new_plugins',
    icon: 'icon-star',
    location: 'mainNavigation',
  }
]
```
ì„¤ì • ë©”ë‰´ ë‚´ì—ë§Œ ë°°ì¹˜í•˜ë ¤ëŠ” ê²½ìš°, ì•„ë˜ ì˜ˆì‹œë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.

```tsx
menus: [
  {
    text: 'New plugin',
    to: '/new_plugins',
    image: '/images/icons/erxes-18.svg',
    location: 'settings',
    scope: 'new_plugin'
  }
]
```

# í”ŒëŸ¬ê·¸ì¸ í™œì„±í™”
`cli/configs.json` íŒŒì¼ ë‚´ì˜ "plugins" ì„¹ì…˜ì—ëŠ” erxes ì‹œì‘ ì‹œ ì‹¤í–‰ë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ì„ í™œì„±í™”í•˜ê±°ë‚˜, ì œê±°í•˜ê±°ë‚˜, ì¬ìƒì„±í•˜ê¸°ë¡œ ê²°ì •í•œ ê²½ìš° ì´ ì„¹ì…˜ì„ êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

```tsx
{
 "jwt_token_secret": "token",
 "dashboard": {},
 "client_portal_domains": "",
 "elasticsearch": {},
 "redis": {
   "password": ""
 },
 "mongo": {
   "username": "",
   "password": ""
 },
 "rabbitmq": {
   "cookie": "",
   "user": "",
   "pass": "",
   "vhost": ""
 },
 "plugins": [
   {
     "name": "logs"
   },
   {
     "name": "new_plugin",
     "ui": "local"
   }
 ]
}
```
# erxes ì‹¤í–‰
`create-plugin` ëª…ë ¹ì€ `cli/configs.json` íŒŒì¼ì— ìƒˆ ì¤„ì„ ìë™ìœ¼ë¡œ ì¶”ê°€í•˜ê³  í•„ìš”í•œ ì¢…ì†ì„±ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```tsx
{
    "jwt_token_secret": "token",
    "client_portal_domains": "",
    "elasticsearch": {},
    "redis": {
        "password": "pass"
    },
    "mongo": {
        "username": "",
        "password": ""
    },
    "rabbitmq": {
        "cookie": "",
        "user": "",
        "pass": "",
        "vhost": ""
    },
    "plugins": [
      {
        "name": "new_plugin",
        "ui": "local"
      }
    ]
}
```
2. ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”.
```tsx
cd erxes/cli
yarn install
```

3. ìƒˆë¡œ ì„¤ì¹˜í•œ í”ŒëŸ¬ê·¸ì¸ê³¼ í•¨ê»˜ erxesë¥¼ ì‹œì‘í•˜ë ¤ë©´ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”.
```tsx
./bin/erxes.js dev
```





## Integration í”ŒëŸ¬ê·¸ì¸ ìƒì„±

Integrationì€ Inbox í”ŒëŸ¬ê·¸ì¸ì˜ í™•ì¥ìœ¼ë¡œ, íƒ€ì‚¬ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ê³µìœ  Inboxì— í†µí•©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

<Caution>
ì§„í–‰í•˜ê¸° ì „ì—, [ê°€ì´ë“œë¼ì¸](/sdks/creategen)ì„ ì½ì–´ë³´ì‹œê³ , [ë§ˆì¼“í”Œë ˆì´ìŠ¤](https://erxes.io/marketplace)<script src='https://cdn.jsdelivr.net/gh/eddymens/markdown-external-link-script@v2.0.0/main.min.js'></script>ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ì¡´ì˜ í†µí•© ì˜ˆì œë¥¼ í™•ì¸í•´ë³´ì„¸ìš”. ì˜ˆì œë¡œ ì‚¬ìš©í•  IMAP í†µí•©ì€ [ì—¬ê¸°](https://github.com/erxes/erxes-community/tree/dev/packages)<script src='https://cdn.jsdelivr.net/gh/eddymens/markdown-external-link-script@v2.0.0/main.min.js'></script>ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</Caution>

ì´ë¯¸ ìœ„ ê°€ì´ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í–ˆë‹¤ê³  ê°€ì •í•˜ê³ , í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ì€ IMAPì…ë‹ˆë‹¤.

configs.jsonì— ë‹¤ìŒ Inbox ê´€ë ¨ í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•˜ê³  ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”.

```tsx
 "plugins": [
        {
            "name": "forms",
            "ui": "remote"
        },
        {
            "name": "contacts",
            "ui": "local"
        },
        {
            "name": "inbox",
            "ui": "local"
        },
        {
            "name": "imap",
            "ui": "local"
        }
```

# Inbox í†µí•©ì˜ í•µì‹¬ ê°œë…
1. **Brand** - ë°ì´í„° ë¶„ë¦¬ì˜ ê°€ì¥ í° ìˆ˜ì¤€. íšŒì‚¬ê°€ 3ê°œì˜ ìíšŒì‚¬ë¥¼ í¬í•¨í•˜ëŠ” ê·¸ë£¹ íšŒì‚¬ë¼ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì´ ê²½ìš° ê° ë¸Œëœë“œëŠ” ê° ìíšŒì‚¬ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
2. **Channel** - í†µí•© ë° íŒ€ ë©¤ë²„ ê·¸ë£¹ìœ¼ë¡œ, ëˆ„ê°€ ì–´ë–¤ í†µí•©ì„ ë‹´ë‹¹í•˜ëŠ”ì§€ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
3. **Integration** - IMAPì˜ ê²½ìš°, ì´ë©”ì¼ ì£¼ì†Œ, ë¹„ë°€ë²ˆí˜¸, smtp í˜¸ìŠ¤íŠ¸ ë“±ì„ í¬í•¨í•˜ëŠ” ì„¤ì • ì§‘í•©ì…ë‹ˆë‹¤.
4. **Customer** - IMAPì˜ ê²½ìš°, ì´ë©”ì¼ì„ ë³´ë‚¸ ì‚¬ëŒì…ë‹ˆë‹¤.
5. **Conversation** - IMAPì˜ ê²½ìš°, ì „ì²´ ì´ë©”ì¼ ìŠ¤ë ˆë“œì…ë‹ˆë‹¤.
6. **Conversation Messages** - IMAPì˜ ê²½ìš°, ë‹¨ì¼ ì´ë©”ì¼ ìŠ¤ë ˆë“œì˜ ê° ì´ë©”ì¼ í•­ëª©ì…ë‹ˆë‹¤.

# í†µí•©ì˜ ìƒëª… ì£¼ê¸°
1. í•´ë‹¹ ì„¤ì •ì„ ì‚¬ìš©í•˜ì—¬ í†µí•© ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , ì´ë¥¼ inboxì˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤. ì´í›„ ì›í•˜ëŠ” APIì™€ ì‘ì—…í•  ë•Œ ì´ ì„¤ì •ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
2. plugin-"integration-name"-apiì—ì„œ í†µí•© ì„¤ì •ì„ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” APIë¡œë¶€í„° ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•©ë‹ˆë‹¤.
3. ìˆ˜ì‹ ëœ ë°ì´í„°ë¥¼ ëŒ€í™”, ëŒ€í™” ë©”ì‹œì§€, ê³ ê°ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤. ëŒ€í™”ëŠ” inboxì˜ ë°ì´í„°ë² ì´ìŠ¤ì—, ê³ ê°ì€ contactsì˜ ë°ì´í„°ë² ì´ìŠ¤ì—, ëŒ€í™” ë©”ì‹œì§€ëŠ” í”ŒëŸ¬ê·¸ì¸ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.
4. ëŒ€í™”ì™€ ê³ ê°ì„ ì €ì¥í•˜ë©´ inboxì˜ ì‚¬ì´ë“œë°”ì— í‘œì‹œë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëŒ€í™”ì˜ ì„¸ë¶€ ì‚¬í•­ì€ í”ŒëŸ¬ê·¸ì¸ì˜ UIì—ì„œ ë‹´ë‹¹í•´ì•¼ í•©ë‹ˆë‹¤.
5. ëŒ€í™” ì„¸ë¶€ ì‚¬í•­ì„ í‘œì‹œí•  ìˆ˜ ìˆëŠ” ë§Œí¼, ê³ ê°ì—ê²Œ ì‘ë‹µì„ ë³´ë‚´ëŠ” ë“±ì˜ ì¶”ê°€ ì‘ì—…ë„ ë‹´ë‹¹í•´ì•¼ í•©ë‹ˆë‹¤.

# IMAPì„ ì˜ˆë¡œ ë“¤ì–´ ìœ„ ë‹¨ê³„ë¥¼ ì‹œì—°í•´ ë³´ê² ìŠµë‹ˆë‹¤
## í†µí•© ìƒì„±
plugin-imap-uiì˜ configs.jsë¥¼ ì‚´í´ë´…ì‹œë‹¤

```tsx
 inboxIntegration: {
    name: 'IMAP',
    description:
      'Connect a company email address such as sales@mycompany.com or info@mycompany.com',
    isAvailable: true,
    kind: 'imap',
    logo: '/images/integrations/email.png',
    createModal: 'imap',
    createUrl: '/settings/integrations/imap',
    category:
      'All integrations, For support teams, Marketing automation, Email marketing'
  }
  ```
/settings/integrations ìœ„ì¹˜ì— ë‹¤ìŒ ë¸”ë¡ì„ ìƒì„±í•©ë‹ˆë‹¤.

![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/5e5d8967-e17a-45ac-5bac-f25fe6351300/public)


  ```tsx
  "./inboxIntegrationForm": "./src/components/IntegrationForm.tsx",
  ```
  and

  ```tsx
inboxIntegrationForm: './inboxIntegrationForm',
  ```

 ìœ„ ê·¸ë¦¼ì—ì„œ add ë§í¬ë¥¼ í´ë¦­í•˜ë©´ `./src/components/IntegrationForm.tsx` ì»´í¬ë„ŒíŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.

![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/e4ed1a7b-874c-4b1a-201b-ce0c7a14e300/public)

"Save" ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ë©”ì‹œì§€ê°€ `plugin-imap-api`ë¡œ ì „ì†¡ë©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ì†Œë¹„ìë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

```tsx
consumeRPCQueue(
  'imap:createIntegration',
  async ({ subdomain, data: { doc, integrationId } }) => {
    const models = await generateModels(subdomain);

    const integration = await models.Integrations.create({
      inboxId: integrationId,
      ...doc
    });

    await listenIntegration(subdomain, integration);

    await models.Logs.createLog({
      type: 'info',
      message: `Started syncing ${integration.user}`
    });

    return {
      status: 'success'
    };
  }
);
```
[here is the example](https://github.com/erxes/erxes-community/blob/dev/packages/plugin-imap-api/src/messageBroker.ts)<script src='https://cdn.jsdelivr.net/gh/eddymens/markdown-external-link-script@v2.0.0/main.min.js'></script>
# ì›í•˜ëŠ” APIì—ì„œ ë°ì´í„° ìˆ˜ì‹ 

[here is the code example](https://github.com/erxes/erxes-community/blob/dev/packages/plugin-imap-api/src/utils.ts)<script src='https://cdn.jsdelivr.net/gh/eddymens/markdown-external-link-script@v2.0.0/main.min.js'></script>

# ë°ì´í„° ì €ì¥
1. 
```tsx
const apiCustomerResponse = await sendContactsMessage({
  subdomain,
  action: 'customers.createCustomer',
  data: {
    integrationId: integration.inboxId,
    primaryEmail: from
  },
  isRPC: true
});
```
createCustomer ë©”ì‹œì§€ë¥¼ contacts í”ŒëŸ¬ê·¸ì¸ì— ë³´ë‚´ë©´ contacts í”ŒëŸ¬ê·¸ì¸ì´ ì´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.

2. 
```tsx
const { _id } = await sendInboxMessage({
  subdomain,
  action: 'integrations.receive',
  data: {
    action: 'create-or-update-conversation',
    payload: JSON.stringify({
      integrationId: integration.inboxId,
      customerId,
      createdAt: msg.date,
      content: msg.subject
    })
  },
  isRPC: true
});
```
create ë˜ëŠ” update conversation ë©”ì‹œì§€ë¥¼ inbox í”ŒëŸ¬ê·¸ì¸ì— ë³´ë‚´ë©´ inbox í”ŒëŸ¬ê·¸ì¸ì´ ì´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤.

# ëŒ€í™” ì„¸ë¶€ ì‚¬í•­
plugin-imap-uiì˜ configs.jsì—ì„œ

```tsx
"./inboxConversationDetail": "./src/components/ConversationDetail.tsx",
```

and

```tsx
inboxConversationDetail: './inboxConversationDetail',
```

ëŒ€í™” ì„¸ë¶€ ì‚¬í•­ ì„¹ì…˜ì—ì„œ `./src/components/ConversationDetail.tsx` ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/3cd9edd4-bf11-412a-d4c4-c89127a33000/public)

# ìƒˆë¡œìš´ í†µí•© í”ŒëŸ¬ê·¸ì¸ ìƒì„±
ê° í”ŒëŸ¬ê·¸ì¸ì€ `API`ì™€ `UI`ì˜ ë‘ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

1. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ë¶€ë¶„ì— ëŒ€í•œ ìƒˆ í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```tsx
cd erxes
yarn create-plugin
```

ìœ„ ëª…ë ¹ì–´ëŠ” CLIë¥¼ ì‹œì‘í•˜ì—¬ ìƒˆ í†µí•© í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•˜ê¸° ìœ„í•œ ëª‡ ê°€ì§€ ì§ˆë¬¸ì„ ë¬»ìŠµë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” twitter í†µí•©ì„ ìƒì„±í•©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/95a9c88c-1c84-4f08-ce28-75170897fc00/public)

ì•„ë˜ ì˜ˆì œëŠ” ì˜ˆì œ í…œí”Œë¦¿ì—ì„œ ìƒì„±ëœ ìƒˆë¡œìš´ í†µí•© í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ, ì„¤ì • í†µí•©ì— ë°°ì¹˜ë©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/add9ac3a-0d02-44e6-a9c6-5a1a0ae3fb00/public)

ì•„ë˜ ì˜ˆì œëŠ” ì˜ˆì œ í…œí”Œë¦¿ì—ì„œ ìƒì„±ëœ ìƒˆë¡œìš´ í†µí•© í”ŒëŸ¬ê·¸ì¸ì˜ êµ¬ì„±ìœ¼ë¡œ, ì„¤ì • í†µí•© êµ¬ì„±ì— ë°°ì¹˜ë©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/08761770-ac2e-4ce2-cddf-dfdfef8daa00/public)

ì•„ë˜ ì˜ˆì œëŠ” í¼ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì˜ˆì œ í†µí•©ì„ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/23337484-540c-4cdc-cbb5-ce25ce22f300/public)

ì•„ë˜ ì˜ˆì œëŠ” ì„¸ë¶€ í˜ì´ì§€ì™€ í•¨ê»˜ ìƒˆë¡œìš´ í†µí•©ì„ ìƒì„±í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. í†µí•© í”ŒëŸ¬ê·¸ì¸ UI í…œí”Œë¦¿ì—ì„œ **with detail** ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ì¶”ê°€ ë²„íŠ¼ì„ í´ë¦­í•  ë•Œ ì„¸ë¶€ í˜ì´ì§€ë¡œ ì—°ê²°ë©ë‹ˆë‹¤.
![](https://imagedelivery.net/5m26Aj-CutMXPPNacMs_yQ/9c4e7e6a-cac5-49c4-d2c8-4c0aa1925500/public)

## API íŒŒì¼ êµ¬ì¡°
í†µí•© í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•œ í›„, í†µí•© í”ŒëŸ¬ê·¸ì¸ APIì— ë‹¤ìŒ íŒŒì¼ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

```tsx
ğŸ“¦plugin-twitter-api
 â”£ ğŸ“‚src
 â”ƒ â”£ ğŸ“‚graphql
 â”ƒ â”ƒ â”£ ğŸ“‚resolvers
 â”ƒ â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”ƒ â”£ mutations.ts
 â”ƒ â”ƒ â”ƒ â”— queries.ts
 â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”— typeDefs.ts
 â”ƒ â”£ configs.ts
 â”ƒ â”£ controller.ts
 â”ƒ â”£ messageBroker.ts
 â”ƒ â”— models.ts
 â”£ .env.sample
 â”£ package.json
 â”— tsconfig.json
 ```

# ì£¼ìš” íŒŒì¼
ë‹¤ìŒ íŒŒì¼ë“¤ì´ plugin-[pluginName]-api/srcì— ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

# configs.ts
ì´ íŒŒì¼ì—ëŠ” í†µí•© í”ŒëŸ¬ê·¸ì¸ì˜ ì£¼ìš” ì„¤ì •ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'configs.ts file:' }}
// path: ./packages/plugin-[pluginName]-api/src/configs.ts 
  import typeDefs from './graphql/typeDefs';
  import resolvers from './graphql/resolvers';
  import { initBroker } from './messageBroker';
  import init from './controller';
  export let mainDb;
  export let graphqlPubsub;
  export let serviceDiscovery;
  export let debug;
  export default {
    name: 'twitter',
    graphql: sd => {
      serviceDiscovery = sd;
      return {
        typeDefs,
        resolvers
      };
    },
    meta: {
      // this code will show the integration in UI settings -> integrations
      inboxIntegration: {
        kind: 'twitter',
        label: 'Twitter'
      }
    },
    apolloServerContext: async (context) => {
      return context;
    },
    onServerInit: async options => {
      const app = options.app;
      mainDb = options.db;
      debug = options.debug;
      graphqlPubsub = options.pubsubClient;
      initBroker(options.messageBrokerClient);
      // integration controller
      init(app);
    }
  };
  ```
# controller.ts
ì´ íŒŒì¼ì—ëŠ” í†µí•©ì„ ë“£ê³ , erxesì™€ ì—°ê²°í•˜ê³  ëŒ€í™”ì™€ ê³ ê°ì„ ìƒì„±í•˜ëŠ” í†µí•© ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” ë©”ì‹œì§€ ì €ì¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
```bash {{ title: 'controller.ts file:' }}
import { sendContactsMessage, sendInboxMessage } from './messageBroker';
  import { Customers, Messages } from './models';
  // util function
  const searchMessages = (linkedin, criteria) => {
    return new Promise((resolve, reject) => {
      const messages: any = [];
    });
  };
  // Example for save messages to inbox and create or update customer
  const saveMessages = async (
    linkedin,
    integration,
    criteria
  ) => {
    const msgs: any = await searchMessages(linkedin, criteria);
    for (const msg of msgs) {
      const message = await Messages.findOne({
        messageId: msg.messageId
      });
      if (message) {
        continue;
      }
      const from = msg.from.value[0].address;
      const prev = await Customers.findOne({ email: from });
      let customerId;
      if (!prev) {
        // search customer from contacts api
        const customer = await sendContactsMessage({
          subdomain: 'os',
          action: 'customers.findOne',
          data: {
            primaryEmail: from
          },
          isRPC: true
        });
        if (customer) {
          customerId = customer._id;
        } else {
          // creating new customer
          const apiCustomerResponse = await sendContactsMessage({
            subdomain: 'os',
            action: 'customers.createCustomer',
            data: {
              integrationId: integration.inboxId,
              primaryEmail: from
            },
            isRPC: true
          });
          customerId = apiCustomerResponse._id;
        }
        await Customers.create({
          inboxIntegrationId: integration.inboxId,
          contactsId: customerId,
          email: from
        });
      } else {
        customerId = prev.contactsId;
      }
      let conversationId;
      const relatedMessage = await Messages.findOne({
        $or: [
          { messageId: msg.inReplyTo },
          { messageId: { $in: msg.references || [] } },
          { references: { $in: [msg.messageId] } },
          { references: { $in: [msg.inReplyTo] } }
        ]
      });
      if (relatedMessage) {
        conversationId = relatedMessage.inboxConversationId;
      } else {
        const { _id } = await sendInboxMessage({
          subdomain: 'os',
          action: 'integrations.receive',
          data: {
            action: 'create-or-update-conversation',
            payload: JSON.stringify({
              integrationId: integration.inboxId,
              customerId,
              createdAt: msg.date,
              content: msg.subject
            })
          },
          isRPC: true
        });
        conversationId = _id;
      }
      await Messages.create({
        inboxIntegrationId: integration.inboxId,
        inboxConversationId: conversationId,
        createdAt: msg.date,
        messageId: msg.messageId,
        inReplyTo: msg.inReplyTo,
        references: msg.references,
        subject: msg.subject,
        body: msg.html,
        to: msg.to && msg.to.value,
        cc: msg.cc && msg.cc.value,
        bcc: msg.bcc && msg.bcc.value,
        from: msg.from && msg.from.value,
      });
    }
  };
  // controller for twitter
  const init = async app => {
    // write integration login method below
    app.get('/login', async (req, res) => {
      res.send("login")
    });
    
    app.post('/receive', async (req, res, next) => {
      try {
        // write receive message from integration code here
        res.send("Successfully receiving message");
      } catch (e) {
        return next(new Error(e));
      }
      res.sendStatus(200);
    });
  };
  export default init;
  ```

# messageBroker.ts
ì´ íŒŒì¼ì€ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ê³¼ ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. [ê³µí†µ ê¸°ëŠ¥](#)ì—ì„œ ë©”ì‹œì§€ ë¸Œë¡œì»¤ ê¸°ëŠ¥ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'messageBroker.ts file:' }}
// path: ./packages/plugin-[pluginName]-api/src/messageBroker.ts 
  import * as dotenv from 'dotenv';
  import {
    ISendMessageArgs,
    sendMessage as sendCommonMessage
  } from '@erxes/api-utils/src/core';
  import { serviceDiscovery } from './configs';
  import { Customers, Integrations, Messages } from './models';
  dotenv.config();
  let client;
  export const initBroker = async cl => {
    client = cl;
    const { consumeRPCQueue } = client;
    consumeRPCQueue(
      'twitter:createIntegration',
      async ({ data: { doc, integrationId } }) => {
        await Integrations.create({
          inboxId: integrationId,
          ...(doc || {})
        });
        return {
          status: 'success'
        };
      }
    );
    consumeRPCQueue(
      'twitter:removeIntegration',
      async ({ data: { integrationId } }) => {
        await Messages.remove({ inboxIntegrationId: integrationId });
        await Customers.remove({ inboxIntegrationId: integrationId });
        await Integrations.remove({ inboxId: integrationId });
        return {
          status: 'success'
        };
      }
    );
  };
  export default function() {
    return client;
  }
  export const sendContactsMessage = (args: ISendMessageArgs) => {
    return sendCommonMessage({
      client,
      serviceDiscovery,
      serviceName: 'contacts',
      ...args
    });
  };
  export const sendInboxMessage = (args: ISendMessageArgs) => {
    return sendCommonMessage({
      client,
      serviceDiscovery,
      serviceName: 'inbox',
      ...args
    });
  };
  ```
  
# GraphQL ê°œë°œ
`packages/plugin-<new_plugin>-api/src` ë‚´ë¶€ì— `graphql` í´ë”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í´ë”ì—ëŠ” GraphQLê³¼ ê´€ë ¨ëœ ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```tsx
 ğŸ“‚src
 â”£ ğŸ“‚graphql
 â”ƒ â”£ ğŸ“‚resolvers 
 â”ƒ â”ƒ â”£ index.ts
 â”ƒ â”ƒ â”£ mutations.ts
 â”ƒ â”ƒ â”— queries.ts
 â”ƒ â”£ index.ts
 â”ƒ â”— typeDefs.ts
 ```



 # GraphQL resolvers
`/graphql/resolvers/mutations` í´ë” ë‚´ì— GraphQL mutation ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'mutation examples:' }}
  import { Accounts } from '../../models';
  import { IContext } from "@erxes/api-utils/src/types"
  const twitterMutations = {
    async twitterAccountRemove(_root, {_id}: {_id: string}, _context: IContext) {
      await Accounts.removeAccount(_id);
      return 'deleted';
    }
  };
  export default twitterMutations;
  ```

`/graphql/resolvers/queries` í´ë” ë‚´ì— GraphQL query ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'query examples:' }}
  import { IContext } from '@erxes/api-utils/src/types';
  import { Accounts, Messages } from '../../models';
  const queries = {
    async twitterConversationDetail(
      _root,
      { conversationId },
      _context: IContext
    ) {
      const messages = await Messages.find({
        inboxConversationId: conversationId
      });
      const convertEmails = emails =>
        (emails || []).map(item => ({ name: item.name, email: item.address }));
      return messages.map(message => {
        return {
          _id: message._id,
          mailData: {
            messageId: message.messageId,
            from: convertEmails(message.from),
            to: convertEmails(message.to),
            cc: convertEmails(message.cc),
            bcc: convertEmails(message.bcc),
            subject: message.subject,
            body: message.body,
          }
        };
      });
    },
    async twitterAccounts(_root, _args, _context: IContext) {
      return Accounts.getAccounts();
    }
  };
  export default queries;
  ```

  # GraphQL typeDefs
`/graphql/typeDefs.ts` íŒŒì¼ ë‚´ì— GraphQL typeDefsê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash {{ title: 'typeDefs:' }}
import { gql } from 'apollo-server-express';
  const types = `
    type Twitter {
      _id: String!
      title: String
      mailData: JSON
    }
  `;
  const queries = `
    twitterConversationDetail(conversationId: String!): [Twitter]
    twitterAccounts: JSON
  `;
  const mutations = `
    twitterAccountRemove(_id: String!): String
  `;
  const typeDefs = gql`
    scalar JSON
    scalar Date
    ${types}
    extend type Query {
      ${queries}
    }
    extend type Mutation {
      ${mutations}
    }
  `;
  export default typeDefs;
  ```

# Database ê°œë°œ
`packages/plugin-<new_plugin>-api/src` ë‚´ë¶€ì— `models` íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤. ì´ íŒŒì¼ì—ëŠ” MongoDBì™€ mongoose ê´€ë ¨ ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```tsx
ğŸ“‚src
â”— models.ts
```
# Mongoose ìŠ¤í‚¤ë§ˆ ë° ëª¨ë¸
`src/models.ts` íŒŒì¼ ë‚´ì— Mongoose ìŠ¤í‚¤ë§ˆ ë° ëª¨ë¸ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
```bash {{ title: 'Mongoose schema and model example:' }}
1
```

# UI íŒŒì¼ êµ¬ì¡°
ìë™ìœ¼ë¡œ ìƒì„±ëœ í†µí•© í”ŒëŸ¬ê·¸ì¸ UIì˜ íŒŒì¼ êµ¬ì¡°ëŠ” ì¼ë°˜ í”ŒëŸ¬ê·¸ì¸ê³¼ ë™ì¼í•©ë‹ˆë‹¤. ìœ ì¼í•œ ì°¨ì´ì ì€ UI êµ¬ì„±ì…ë‹ˆë‹¤. ì¼ë°˜ í”ŒëŸ¬ê·¸ì¸ UI íŒŒì¼ êµ¬ì¡°ë¥¼ ë³´ë ¤ë©´ [ì—¬ê¸°](#)ë¥¼ í´ë¦­í•˜ì„¸ìš”.

# UI êµ¬ì„±

# í”ŒëŸ¬ê·¸ì¸ ì‹¤í–‰ í¬íŠ¸
`packages/plugin-<new_plugin>-ui/src/configs.js` ë‚´ë¶€ì— í”ŒëŸ¬ê·¸ì¸ UIì˜ ì‹¤í–‰ í¬íŠ¸ê°€ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ 3024ì…ë‹ˆë‹¤. ê° í”ŒëŸ¬ê·¸ì¸ì€ ê³ ìœ í•œ í¬íŠ¸ì—ì„œ UIë¥¼ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤. ì—¬ëŸ¬ í”ŒëŸ¬ê·¸ì¸ì„ ê°œë°œí•˜ëŠ” ê²½ìš° í¬íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤(`configs.js` ë‚´ë¶€).

```tsx
module.exports = {
  name: 'twitter',
  scope: 'twitter',
  port: 3024,
  exposes: {
    './routes': './src/routes.tsx',

    // ì•„ë˜ ì»´í¬ë„ŒíŠ¸ëŠ” ë™ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ì´ ê²½ìš°, inbox-uiì—ì„œ ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
    './inboxIntegrationSettings': './src/components/IntegrationSettings.tsx',
    './inboxIntegrationForm': './src/components/IntegrationForm.tsx',
    './inboxConversationDetail': './src/components/ConversationDetail.tsx'

  },
  routes: {
    url: 'http://localhost:3024/remoteEntry.js',
    scope: 'twitter',
    module: './routes'
  },

  // calling exposed components
  inboxIntegrationSettings: './inboxIntegrationSettings',
  inboxIntegrationForm: './inboxIntegrationForm',
  inboxConversationDetail: './inboxConversationDetail',

  inboxIntegration: {
    name: 'Twitter',

   // í†µí•© ì„¤ëª…ì´ í†µí•© ìƒìì— í‘œì‹œë©ë‹ˆë‹¤.
    description:
      'Please write integration description on plugin config file',
    
    // ì´ ë³€ìˆ˜ëŠ” í†µí•©ì´ í”„ë¡œë•ì…˜ ëª¨ë“œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê°œë°œ ëª¨ë“œì—ì„œëŠ” í•­ìƒ true ê°’ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
    isAvailable: true,

    // í†µí•© ìœ í˜•ì€ ë™ì ìœ¼ë¡œ í†µí•© ì–‘ì‹ì„ í˜¸ì¶œí•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. 
    kind: 'twitter',

    // í†µí•© ë¡œê³ 
    logo: '/images/integrations/twitter.png',
    
    // CLIë¥¼ ì‚¬ìš©í•˜ì—¬ í†µí•© í”ŒëŸ¬ê·¸ì¸ì„ ìƒì„±í•  ë•Œ ìƒì„¸ í˜ì´ì§€ë¥¼ ì„ íƒí•œ ê²½ìš°, í†µí•© ìƒìì—ì„œ ì¶”ê°€ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ í†µí•©ì´ ì´ URLë¡œ ì—°ê²°ë©ë‹ˆë‹¤.
    createUrl: '/settings/integrations/twitter',
  }
};
```
# ë™ì  ì»´í¬ë„ŒíŠ¸ í”ŒëŸ¬ê·¸ì¸ í˜¸ì¶œ
í”ŒëŸ¬ê·¸ì¸ inbox UIì—ì„œ ë™ì ìœ¼ë¡œ í˜¸ì¶œë˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ìˆëŠ” íŒŒì¼.

**inboxIntegrationSettings.tsx ì»´í¬ë„ŒíŠ¸**
`packages/plugin-inbox-ui/src/settings/integrationsConfig/components/IntegrationConfigs.tsx` ë‚´ë¶€ì— `loadDynamicComponent` í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œëŠ” plugin inbox UIì—ì„œ integrationConfigs ì»´í¬ë„ŒíŠ¸ë¥¼ ë™ì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

```tsx
{loadDynamicComponent(
    'inboxIntegrationSettings',
    {
      renderItem: this.renderItem
    },
    true
  )}
```

**inboxIntegrationForm.tsx ì»´í¬ë„ŒíŠ¸**
`packages/plugin-inbox-ui/src/settings/integrations/containers/common/IntegrationForm.tsx` ë‚´ë¶€ì— `loadDynamicComponent` í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œëŠ” plugin inbox UIì—ì„œ integrationForm ì»´í¬ë„ŒíŠ¸ë¥¼ ë™ì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

```tsx
return loadDynamicComponent(
  'inboxIntegrationForm',
  updatedProps,
  false,
  type
);
```

**inboxConversationDetail.tsx ì»´í¬ë„ŒíŠ¸**
`packages/plugin-inbox-ui/src/inbox/components/conversationDetail/workarea/WorkArea.tsx` ë‚´ë¶€ì— `loadDynamicComponent` í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œëŠ” plugin inbox UIì—ì„œ inboxConversationDetail ì»´í¬ë„ŒíŠ¸ë¥¼ ë™ì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

```tsx
content = loadDynamicComponent('inboxConversationDetail', {
  ...this.props
});
```

## í”ŒëŸ¬ê·¸ì¸ í™œì„±í™”
`cli/configs.json`ì˜ "plugins" ì„¹ì…˜ì—ëŠ” erxesê°€ ì‹œì‘ë  ë•Œ ì‹¤í–‰ë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ì„ í™œì„±í™”í•˜ê±°ë‚˜ ì œê±°í•˜ê±°ë‚˜ ë‹¤ì‹œ ìƒì„±í•˜ë ¤ëŠ” ê²½ìš° ì´ ì„¹ì…˜ì„ êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤.
```tsx
{
 "jwt_token_secret": "token",
 "dashboard": {},
 "client_portal_domains": "",
 "elasticsearch": {},
 "redis": {
   "password": ""
 },
 "mongo": {
   "username": "",
   "password": ""
 },
 "rabbitmq": {
   "cookie": "",
   "user": "",
   "pass": "",
   "vhost": ""
 },
 "plugins": [
   {
     "name": "logs"
   },
   {
     "name": "new_plugin",
     "ui": "local"
   }
 ]
}
```

# erxes ì‹¤í–‰
`create-plugin` ëª…ë ¹ì€ `cli/configs.json`ì— ìƒˆë¡œìš´ ì¤„ì„ ìë™ìœ¼ë¡œ ì¶”ê°€í•˜ê³  í•„ìš”í•œ ì¢…ì†ì„±ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```tsx
{
    "jwt_token_secret": "token",
    "client_portal_domains": "",
    "elasticsearch": {},
    "redis": {
        "password": "pass"
    },
    "mongo": {
        "username": "",
        "password": ""
    },
    "rabbitmq": {
        "cookie": "",
        "user": "",
        "pass": "",
        "vhost": ""
    },
    "plugins": [
        {
            "name": "forms",
            "ui": "remote"
        },
        {
            "name": "contacts",
            "ui": "local"
        },
        {
            "name": "inbox",
            "ui": "local"
        },
        {
            "name": "twitter",
            "ui": "local"
        },
    ]
}
```
2. ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
```tsx
cd erxes/cli
yarn install
```

3. ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ìƒˆë¡œ ì„¤ì¹˜ëœ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ erxesë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
```tsx
./bin/erxes.js dev
```